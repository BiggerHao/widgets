var{toDirectedGraph:e}=require("@xstate/graph"),{createMachine:t,assign:a,interpret:n}=require("xstate"),{App:r,ArrowDB:i}=require("falcon-vis");const s={readyIndicator:!1,chartCount:!1,showUnfiltered:!0,toggleUnfiltered:!1,zeroD:"hbar",circleHeatmap:!1,showInterestingness:!1,progressiveInteractions:!1,interpolate:!1,zoom:!1,renderer:"svg",maxInteractiveResolution1D:1/0,maxInteractiveResolution2D:80,barHeight:200,barWidth:350,histogramWidth:350,heatmapWidth:400,maxCircleSize:800};function o(e,t){return{states:{noBrush:{initial:"idle",states:{idle:{on:{mousedown:{target:"readyToAddBrush",cond:{type:"targetMatches",target:"chart"}}}},readyToAddBrush:{on:{mousemove:{target:"addingBrush",actions:"setBrushExists"},mouseup:[{target:`#${e}.active.${t}.hasBrush`,cond:"activeBrushExists"},{target:"idle"}]}},addingBrush:{entry:"updateValues",on:{mousemove:{target:"addingBrush",internal:!1},mouseup:`#${e}.active.${t}.hasBrush`}}}},hasBrush:{type:"parallel",on:{clickReset:{target:"noBrush",actions:["resetBrushExists","resetValues"]},mousedownChart:"noBrush.readyToAddBrush"},states:{handleA:{initial:"idle",states:{idle:{on:{mousedown:{target:"startMoving",cond:{type:"targetMatches",target:"A"}}},always:[{target:"extreme.min",cond:"minA"},{target:"extreme.max",cond:"maxA"}]},startMoving:{on:{mousemove:[{target:"moving.progressing",cond:"progressA"},{target:"moving.regressing",cond:"regressA"}],mouseup:"idle"},always:[{target:"movingExtreme.min",cond:"minA"},{target:"movingExtreme.max",cond:"maxA"}]},moving:{entry:"updateValues",on:{mousemove:[{target:".progressing",cond:"progressA",internal:!1},{target:".regressing",cond:"regressA",internal:!1}],mouseup:"idle"},always:[{target:"movingExtreme.min",cond:"minA"},{target:"movingExtreme.max",cond:"maxA"}],states:{progressing:{},regressing:{}}},movingExtreme:{on:{mouseup:"idle"},states:{min:{on:{mousemove:{target:`#${e}.active.${t}.hasBrush.handleA.moving.progressing`,cond:"progressA"}}},max:{on:{mousemove:{target:`#${e}.active.${t}.hasBrush.handleA.moving.regressing`,cond:"regressA"}}}}},extreme:{on:{mousedown:{target:"startMoving",cond:{type:"targetMatches",target:"A"}},mousedown:{target:"updating",cond:{type:"targetMatches",target:"bar"}}},states:{min:{},max:{}}},updating:{on:{mouseup:"idle"}}}},handleB:{initial:"idle",states:{idle:{on:{mousedown:{target:"startMoving",cond:{type:"targetMatches",target:"B"}}},always:[{target:"extreme.min",cond:"minB"},{target:"extreme.max",cond:"maxB"}]},startMoving:{on:{mousemove:[{target:"moving.progressing",cond:"progressB"},{target:"moving.regressing",cond:"regressB"}],mouseup:"idle"},always:[{target:"movingExtreme.min",cond:"minB"},{target:"movingExtreme.max",cond:"maxB"}]},moving:{entry:"updateValues",on:{mousemove:[{target:".progressing",cond:"progressB",internal:!1},{target:".regressing",cond:"regressB",internal:!1}],mouseup:"idle"},always:[{target:"movingExtreme.min",cond:"minB"},{target:"movingExtreme.max",cond:"maxB"}],states:{progressing:{},regressing:{}}},movingExtreme:{on:{mouseup:"idle"},states:{min:{on:{mousemove:{target:`#${e}.active.${t}.hasBrush.handleB.moving.progressing`,cond:"progressB"}}},max:{on:{mousemove:{target:`#${e}.active.${t}.hasBrush.handleB.moving.regressing`,cond:"regressB"}}}}},extreme:{on:{mousedown:[{target:"startMoving",cond:{type:"targetMatches",target:"B"}},{target:"updating",cond:{type:"targetMatches",target:"bar"}}]},states:{min:{},max:{}}},updating:{on:{mouseup:"idle"}}}},bar:{initial:"idle",states:{idle:{on:{mousedown:{target:"startMoving",cond:{type:"targetMatches",target:"bar"}}},always:[{target:"minMax",cond:"minMaxBar"},{target:"extreme.min",cond:"minBar"},{target:"extreme.max",cond:"maxBar"}]},startMoving:{on:{mousemove:[{target:"moving.progressing",cond:"progressA"},{target:"moving.regressing",cond:"regressA"}],mouseup:"idle"},always:[{target:"movingExtreme.min",cond:"minBar"},{target:"movingExtreme.max",cond:"maxBar"}]},moving:{entry:"updateValues",on:{mousemove:[{target:".progressing",cond:"progressA",internal:!1},{target:".regressing",cond:"regressA",internal:!1}],mouseup:"idle"},always:[{target:"movingExtreme.min",cond:"minBar"},{target:"movingExtreme.max",cond:"maxBar"}],states:{progressing:{},regressing:{}}},movingExtreme:{on:{mouseup:"idle"},states:{min:{on:{mousemove:{target:`#${e}.active.${t}.hasBrush.bar.moving.progressing`,cond:"progressA"}}},max:{on:{mousemove:{target:`#${e}.active.${t}.hasBrush.bar.moving.regressing`,cond:"regressA"}}}}},extreme:{on:{mousedown:[{target:"startMoving",cond:{type:"targetMatches",target:"bar"}},{target:"updating",cond:{type:"targetMatches",target:"A"}},{target:"updating",cond:{type:"targetMatches",target:"B"}}]},states:{min:{},max:{}}},minMax:{on:{mousedown:[{target:"updating",cond:{type:"targetMatches",target:"A"}},{target:"updating",cond:{type:"targetMatches",target:"B"}}]}},updating:{on:{mouseup:"idle"}}}}}}}}}function m(e){return[{target:`active.${e}.hasBrush`,cond:"brushExists"},{target:`active.${e}.noBrush`}]}const c=t({id:"crossfilter",initial:"inactive",states:{inactive:{entry:"resetActiveView",on:{mouseenterDistance:m("distance"),mouseenterArrTime:m("arrTime"),mouseenterDepTime:m("depTime"),mouseenterDepDelay:m("depDelay"),mouseenterArrDelay:m("arrDelay"),mouseenterAirTime:m("airTime")}},active:{entry:"setActiveView",on:{mouseleaveWidget:"inactive"},states:{distance:o("crossfilter","distance"),arrTime:o("crossfilter","arrTime"),depTime:o("crossfilter","depTime"),depDelay:o("crossfilter","depDelay"),arrDelay:o("crossfilter","arrDelay"),airTime:o("crossfilter","airTime")}}}},{guards:{brushExists:(e,t)=>e.brushExists.get(t.viewName),activeBrushExists:(e,t)=>e.brushExists.get(e.activeViewName),targetMatches:(e,t,{cond:a})=>t.target==a.target,progressA:(e,t)=>t.valueA>e.valueA.get(e.activeViewName),regressA:(e,t)=>t.valueA<e.valueA.get(e.activeViewName),progressB:(e,t)=>t.valueB>e.valueB.get(e.activeViewName),regressB:(e,t)=>t.valueB<e.valueB.get(e.activeViewName),minA:(e,t)=>e.valueA.get(e.activeViewName)==e.minValue.get(e.activeViewName),maxA:(e,t)=>e.valueA.get(e.activeViewName)==e.maxValue.get(e.activeViewName),minB:(e,t)=>e.valueB.get(e.activeViewName)==e.minValue.get(e.activeViewName),maxB:(e,t)=>e.valueB.get(e.activeViewName)==e.maxValue.get(e.activeViewName),minBar:(e,t)=>{const a=e.minValue.get(e.activeViewName);return e.valueA.get(e.activeViewName)==a||e.valueB.get(e.activeViewName)==a},maxBar:(e,t)=>{const a=e.maxValue.get(e.activeViewName);return e.valueA.get(e.activeViewName)==a||e.valueB.get(e.activeViewName)==a},minMaxBar:(e,t)=>{const a=e.minValue.get(e.activeViewName),n=e.maxValue.get(e.activeViewName),r=e.valueA.get(e.activeViewName),i=e.valueB.get(e.activeViewName);return r==a&&i==n||r==n&&i==a}},actions:{setActiveView:a({activeViewName:(e,t)=>t.viewName}),resetActiveView:a({activeViewName:null}),setBrushExists:a({brushExists:(e,t)=>e.brushExists.set(e.activeViewName,!0)}),resetBrushExists:a({brushExists:(e,t)=>e.brushExists.set(e.activeViewName,!1)}),updateValues:a({valueA:(e,t)=>e.valueA.set(e.activeViewName,t.valueA),valueB:(e,t)=>e.valueB.set(e.activeViewName,t.valueB)}),resetValues:a({valueA:(e,t)=>e.valueA.set(e.activeViewName,0),valueB:(e,t)=>e.valueB.set(e.activeViewName,0)})}});let g;function u(e){const t=document.createElement("div");return t.setAttribute("id",e),document.getElementById("app").appendChild(t),t}document.getElementById("app").innerText="";const d=new Map;d.set("COUNT",{title:"Flights selected",type:"0D",el:u("count")}),d.set("DISTANCE",{title:"Distance in Miles",type:"1D",el:u("distance"),dimension:{name:"DISTANCE",bins:25,extent:[0,5e3],format:"d"}}),d.set("ARR_TIME",{title:"Arrival Time",type:"1D",el:u("arrival"),dimension:{name:"ARR_TIME",bins:24,extent:[0,24],format:".1f"}}),d.set("DEP_TIME",{title:"Departure Time",type:"1D",el:u("departure"),dimension:{name:"DEP_TIME",bins:24,extent:[0,24],format:".1f"}}),d.set("DEP_DELAY",{title:"Departure Delay in Minutes",type:"1D",el:u("dep_delay"),dimension:{name:"DEP_DELAY",bins:25,extent:[-20,60],format:".1f"}}),d.set("ARR_DELAY",{title:"Arrival Delay in Minutes",type:"1D",el:u("arr_delay"),dimension:{name:"ARR_DELAY",bins:25,extent:[-20,60],format:".1f"}}),d.set("AIR_TIME",{title:"Airtime in Minutes",type:"1D",el:u("airtime"),dimension:{name:"AIR_TIME",bins:25,extent:[0,500],format:"d"}});var l=null;new r(d,new i(function(){return l||(l=function(){try{throw new Error}catch(t){var e=(""+t.stack).match(/(https?|file|ftp):\/\/[^)\n]+/g);if(e)return(""+e[0]).replace(/^((?:https?|file|ftp):\/\/.+)\/[^/]+$/,"$1")+"/"}return"/"}()),l}()+"flights-10k.1ac8687f.arrow"),{config:s,logger:new class{attach(e,t){}},cb:t=>{document.getElementById("loading").style.display="none";const a=["DISTANCE","ARR_TIME","DEP_TIME","DEP_DELAY","ARR_DELAY","AIR_TIME"],r=function(e,t){const a=new Map;return t.forEach((t=>{a.set(t,e.getVegaView(t))})),a}(t,a),i=new Map,s=new Map,o=new Map,m=new Map,u=new Map,d=new Map,l=new Map,V=new Map,M=new Map,D=new Map,N=new Map;for(const e of a)i.set(e,!1),V.set(e,0),M.set(e,0);!function(e,t,a,n,r,i,s){for(const o in e){const m=e[o];t.set(o,document.querySelector(`#${m}`)),a.set(o,document.querySelector(`#${m} .chart .background`)),n.set(o,document.querySelector(`#${m} .reset`));const c=[document.querySelector(`#${m} .left_grabber`),document.querySelector(`#${m} .left`)];r.set(o,c);const g=[document.querySelector(`#${m} .right_grabber`),document.querySelector(`#${m} .right`)];i.set(o,g),s.set(o,document.querySelector(`#${m} .brush`))}}({DISTANCE:"distance",ARR_TIME:"arrival",DEP_TIME:"departure",DEP_DELAY:"dep_delay",ARR_DELAY:"arr_delay",AIR_TIME:"airtime"},s,o,m,u,d,l),function(e,t,a){for(const[n,r]of e.entries())t.set(n,r.signal("bin").start),a.set(n,r.signal("bin").stop)}(r,D,N);const T={view:r,activeViewName:null,brushExists:i,handleA:u,handleB:d,bar:l,valueA:V,valueB:M,minValue:D,maxValue:N},b=c.withContext(T);g=e(b);const I=n(b);I.onTransition((function(e){e.changed&&function(e,t){const a=e.value,n=e.event.type,r=e.event.viewName,i=Date.now();v.textContent=A(a),p.textContent=`${n} (${y(i)})`,h.textContent=void 0!==r?`viewName: ${r}`:"";w.textContent=e.context.activeViewName,E.textContent=e.context.valueA.get(e.context.activeViewName)+", "+e.context.valueB.get(e.context.activeViewName),x.innerHTML="";B(f(e.value,null,null,null),x,!1)}(e)}));!function(e,t,a,n,r,i,s,o,m){for(const[n,r]of a.entries()){const a=t[n];r.addEventListener("mouseenter",(()=>{e.send({type:`mouseenter${a}`,viewName:n}),m.activeViewName=n})),r.addEventListener("mouseleave",(()=>{e.send("mouseleaveWidget"),m.activeViewName=""}))}for(const[t,a]of n.entries())a.addEventListener("mousedown",(()=>{e.send({type:"mousedown",target:"chart"})}));for(const[t,a]of r.entries())a.addEventListener("click",(()=>{e.send("clickReset")}));for(const[t,a]of i.entries())a.forEach((function(t){t.addEventListener("mousedown",(t=>{e.send({type:"mousedown",target:"A"})}))}));for(const[t,a]of s.entries())a.forEach((function(t){t.addEventListener("mousedown",(t=>{e.send({type:"mousedown",target:"B"})}))}));for(const[t,a]of o.entries())a.addEventListener("mousedown",(t=>{e.send({type:"mousedown",target:"bar"})}));document.addEventListener("mouseup",(t=>{e.send(t)})),document.addEventListener("mousemove",(t=>{if(""!==m.activeViewName){const t=m.view.get(m.activeViewName).signal("brush");"object"==typeof t?e.send({type:"mousemove",valueA:t[0],valueB:t[1]}):e.send("mousemove")}}))}(I,{DISTANCE:"Distance",ARR_TIME:"ArrTime",DEP_TIME:"DepTime",DEP_DELAY:"DepDelay",ARR_DELAY:"ArrDelay",AIR_TIME:"AirTime"},s,o,m,u,d,l,{view:r,activeViewName:""}),I.start()}});const v=document.getElementById("current-state"),p=document.getElementById("last-transition"),h=document.getElementById("last-data"),w=document.getElementById("active-view"),E=document.getElementById("active-view-brush-values"),x=document.getElementById("next-states");const A=function(e){return"string"==typeof e?e:JSON.stringify(e)},y=function(e){return new Date(e).toTimeString().split(" ")[0]};function B(e,t,a){let n=document.createElement("ul");e.forEach((e=>{a&&(n.className="box");let t=" (cond: "+(""!=e.target.cond?e.target.cond:"none")+")";!function(e,t,a,n){let r=document.createElement("li"),i=document.createElement("strong");i.textContent=t,i.className="machine",r.appendChild(i);let s=document.createElement("p");if(s.textContent=a,s.className="machine",r.appendChild(s),n){let e=document.createElement("small");e.textContent=n,e.className="machine",r.appendChild(e)}e.appendChild(r)}(n,e.target.destination,""!=e.target.event?" with "+e.target.event:"eventless",t),e.child&&e.child.length>0&&B(e.child,n,!0)})),t.appendChild(n)}function f(e,t,a,n){let r=[];null==t?(t=0,a=V(e)):t++;let i=[];return a&&a.forEach(((e,t)=>{let a=M(0==t?g.children:i[t-1].children,e);a&&i.push(a)})),i.forEach((e=>{if(e.edges.forEach((a=>{let n=a.target.path;n.includes(a.target.key)||n.push(a.target.key),r.push(D(a,n,t,e.stateNode.key))})),1==t&&e.stateNode.initial){let a=M(e.children,e.stateNode.initial);a&&"inactive"==n&&a.edges.forEach((e=>{r.push(D(e,null,t,n))}))}})),r}function V(e){let t=[],a="string"==typeof(n=e)?null:Object.keys(n)[0];var n;return null!=a?"string"!=typeof a?Object.keys(a).forEach((n=>{t.push(n,...V(e[a][n]))})):t.push(a,...V(e[a])):t.push(e),t}function M(e,t){return e?e.filter((e=>e.stateNode.key==t))[0]:null}function D(e,t,a,n){let r=e.target.path.join(" "),i=e.target.initial;return r+=null==i||e.target.path.includes(i)?"":" "+i,{target:{event:e.transition.event,cond:e.transition.cond?e.transition.cond.name:"",destination:r},child:a<1?f(null,a,t,n):[]}}
//# sourceMappingURL=index.0b6c25d4.js.map
